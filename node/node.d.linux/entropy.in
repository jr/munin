#!/bin/sh
# 
# Plugin to monitor available entropy
#
# Usage: Link or copy into /etc/munin/node.d/
#
# $Log$
# Revision 1.1  2004/01/02 18:50:01  jimmyo
# Renamed occurrances of lrrd -> munin
#
# Revision 1.1.1.1  2004/01/02 15:18:07  jimmyo
# Import of LRRD CVS tree after renaming to Munin
#
# Revision 1.3  2003/11/15 11:10:28  jimmyo
# Various fixes
#
# Revision 1.2  2003/11/07 17:43:16  jimmyo
# Cleanups and log entries
#
#
#
# Magic markers (optional - only used by munin-config and some
# installation scripts):
#
#%# family=auto
#%# capabilities=autoconf



if [ "$1" = "autoconf" ]; then
	if [ -r /proc/sys/kernel/random/entropy_avail ]; then
		echo yes
		exit 0
	else
		echo no
		exit 1
	fi
fi

 
if [ "$1" = "config" ]; then
	echo 'graph_title Available entropy'
	echo 'graph_args --base 1000 -l 0'
	echo 'graph_vlabel entropy (bytes)'
	echo 'graph_scale no'
	echo 'entropy.label entropy'
	exit 0
fi

echo -n "entropy.value "
cat /proc/sys/kernel/random/entropy_avail
