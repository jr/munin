#!/bin/sh
#
# Plugin to monitor harddrive temperatures through SMART.
#
# client-conf.d/-options:
# 	
# 	drives		-- List drives to monitor. E.g. "hda hdc".
#
# $Log$
# Revision 1.1  2004/01/02 15:18:07  jimmyo
# Initial revision
#
# Revision 1.2  2003/12/18 19:16:00  jimmyo
# Changes from Alexandre
#
# Revision 1.1  2003/12/18 19:04:37  jimmyo
# New plugin: Alexandre Dupouy contributed "hddtemp".
#
#
#%# family=contrib

HDDTEMP=/usr/sbin/hddtemp

if [ "$1" = "autoconf" ]; then
        if [ -x "$HDDTEMP" ]; then
                echo yes
                exit 0
        else
                echo no
                exit 1
        fi
fi

if [ "$1" = "config" ]; then

        echo 'graph_title HDD temperature'
        echo 'graph_args --base 1000 -l 0'
        echo 'graph_vlabel temp in °C'
        for a in $drives ; do echo $a.label $a ; done
        exit 0
fi

for a in $drives ; do echo -n "$a.value " ; echo "`hddtemp -q /dev/$a | cut -f 3 -d ':'`" | awk '{print $1}' ; done

